<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.11: http://docutils.sourceforge.net/" />
<title>noesisGUI Documentation: Routed Events Overview</title>
<meta name="description" content="NoesisGUI Documentation"/>

<script type="text/javascript" src="/js/googleAnalytics.js?version=1.0"></script>
<!--[if lt IE 7]><script src="http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js" type="text/javascript"></script><![endif]-->
<link rel="alternate" href="http://feeds.feedburner.com/NoesisTechnologiesNews" type="application/rss+xml" title="Noesis Technologies RSS Feed" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="stylesheet" href="style/noesis.css?version=1.1" type="text/css" />

</head>
<body>
<div class="document" id="routed-events-overview">

<div id="noesis_web_wrap">
    <div class="noesis_web_opC noesis_web_opG" >
        <div id="noesis_web_contenedor">
        
            <div class="noesis_web_headerContenedor">
                <div class="noesis_web_header">
                    <div class="noesis_web_headerInner">
                    
                        <div class="noesis_web_headerLogo">
                            <a href="/" title="Back to main page"><img src="/img/logo_noesis_top.png" alt="Noesis Logo"></img></a>
                        </div>

                        <div class="noesis_web_menu">
                            <ul>
                                <li class="noesis_web_skipMenu"><a href="#content" accesskey="s">Skip to content</a></li>
                                <li class="noesis_web_opA"><a class="noesis_web_opA" href="/noesis_gui_features.htm" accesskey="1" >Products</a></li>
                                <li class="noesis_web_opB"><a class="noesis_web_opB" href="/company_about.htm" accesskey="2" >Company</a></li>
                                <li class="noesis_web_opC"><a class="noesis_web_opC" href="/forums/" accesskey="3" >Support</a></li>
                                <li class="noesis_web_opD"><a class="noesis_web_opD" href="/contact.htm" accesskey="4" >Contact</a></li>
                            </ul>
                        </div>

                        <div class="noesis_web_headerSocial">
                            <a href="http://twitter.com/noesisengine" target="_blank" title="Follow us on Twitter"><img src="/img/icos/Twitter-Icon-28.png"/></a>
                            <a href="http://www.linkedin.com/company/noesis-technologies-sl" target="_blank" title="Follow us on LinkedIn"><img src="/img/icos/Linkedin-Icon-28.png"/></a>
                            <a href="http://vimeo.com/noesisengine" target="_blank" title="Watch us on Vimeo"><img src="/img/icos/Vimeo-Icon-28.png"/></a>
                            <a href="http://www.youtube.com/user/NoesisTechnologies" target="_blank" title="Watch us on YouTube"><img src="/img/icos/Youtube-Icon-28.png"/></a>
                            <a href="http://feeds.feedburner.com/NoesisTechnologiesNews" rel="alternate" type="application/rss+xml" title="RSS News"><img src="/img/icos/RSS-Icon-28.png"/></a>
                        </div>

                        <div class="noesis_web_menu noesis_web_menuSub">
                            <ul>
                                <li class="noesis_web_opJ"><a class="noesis_web_opJ" href="/forums/" accesskey="a">Forums</a></li>
                                <li class="noesis_web_opG"><a class="noesis_web_opG" href="/docs/" accesskey="b">Documentation</a></li>
                                <li class="noesis_web_opK"><a class="noesis_web_opK" href="/community_bugs.htm" accesskey="c">Bugtracking</a></li>
                            </ul>
                        </div>

                    </div>
                </div>                
            </div>

            <div id="noesis_web_main" class="noesis_web_clearfix">
            
                <div id="noesis_web_cabeceraInterior">
                    <div id="noesis_web_cabeceraInteriorArriba">

                        <div class="noesis_web_cabeceraInteriorImagen">&nbsp;</div>

                        <div id="noesis_web_newsBar">
                        
                            <div class="noesis_web_currentContenedor">
                                <div class="noesis_web_current">&nbsp;</div>
                            </div><!--currentContenedor-->
				
                            <div class="noesis_web_menuNB"></div>

                        </div><!--newsContenedor-->

                    </div><!--cabeceraInteriorArriba-->
                </div><!--cabeceraInterior-->
                
                <div id="noesis_web_contenidosMain" class="noesis_web_contenidosMain">

                    <div id="noesis_doc_wrap">
                        <div>
                            <div class="noesis_doc_header_bg">
                                <center><img src="NoesisLogo.png" class="noesis_doc_header_img"></img></center>
                            </div>
                            <div class="noesis_doc_header_menu">
                                <a href="Gui.Core.Index.html" class="noesis_doc_header_link">Documentation Index</a>
                            </div>
                        </div>
                        
                        <div class="noesis_doc_content">

<h1 class="title">Routed Events Overview</h1>

<p>This section describes the concept of routed events, routed events terminology, describes how routed events are routed through a tree of elements, summarizes how you handle routed events, and introduces how to create your own custom routed events.</p>
<p>A routed event is a type of event that can invoke handlers on multiple listeners in an element tree, rather than just on the object that raised the event.</p>
<div class="section" id="c-implementation">
<h1>C++ Implementation</h1>
<p>Each routed event is referenced as an instance of a RoutedEvent class. That handle or identifier must be stored as a class public member, and registered in the UIElementData metadata.</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">MyControl</span><span class="o">:</span> <span class="k">public</span> <span class="n">Gui</span><span class="o">::</span><span class="n">ContentControl</span>
<span class="p">{</span>
    <span class="c1">//...</span>

    <span class="c1">/// Routed events</span>
    <span class="c1">//@{</span>
    <span class="k">static</span> <span class="k">const</span> <span class="n">RoutedEvent</span><span class="o">*</span> <span class="n">DownloadCompletedEvent</span><span class="p">;</span>
    <span class="c1">//@}</span>

    <span class="n">NS_DECLARE_REFLECTION</span><span class="p">(</span><span class="n">MyControl</span><span class="p">,</span> <span class="n">Gui</span><span class="o">::</span><span class="n">ContentControl</span><span class="p">)</span>
<span class="p">};</span>
</pre></div>
<div class="section" id="event-name-conventions">
<h2>Event Name Conventions</h2>
<p>There are established naming conventions regarding routed events too. The routed event itself will have a basic name, <strong>DownloadCompleted</strong>. That name must be unique within each registering type. When you create the identifier field, name this field by the name of the event as you registered it, plus the suffix <strong>Event</strong>. This field is your identifier for the routed event, and it will be used later as an input for the AddHandler and RemoveHandler calls made when registering event handlers. That's why previous example used <strong>DownloadCompletedEvent</strong> as event identifier.</p>
</div>
<div class="section" id="register-event">
<h2>Register Event</h2>
<p>In order for your event to support event routing, you must register that event into a table maintained by the type metadata, and give it a unique identifier. To register the event, you call the <em>RegisterEvent</em> method within the body of your reflection implementation function.</p>
<div class="highlight"><pre><span class="n">NS_IMPLEMENT_REFLECTION</span><span class="p">(</span><span class="n">MyControl</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">NsMeta</span><span class="o">&lt;</span><span class="n">TypeId</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;MyControl&quot;</span><span class="p">);</span>

    <span class="n">Ptr</span><span class="o">&lt;</span><span class="n">UIElementData</span><span class="o">&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="n">NsMeta</span><span class="o">&lt;</span><span class="n">UIElementData</span><span class="o">&gt;</span><span class="p">(</span><span class="n">TypeOf</span><span class="o">&lt;</span><span class="n">SelfClass</span><span class="o">&gt;</span><span class="p">());</span>
    <span class="n">data</span><span class="o">-&gt;</span><span class="n">RegisterEvent</span><span class="p">(</span><span class="n">DownloadCompletedEvent</span><span class="p">,</span> <span class="s">&quot;DownloadCompleted&quot;</span><span class="p">,</span> <span class="n">RoutingStrategy_Bubbling</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="register-event-handlers">
<h2>Register Event Handlers</h2>
<p>Each event will have a function named as the event that will return an Event object. Event class is defined by UIElement and implements <strong>operator +=</strong> to call <em>AddHandler()</em> and <strong>operator -=</strong> to call <em>RemoveHandler()</em>. That way users of the class can add handlers to an event using the operator += easier.</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">MyControl</span><span class="o">:</span> <span class="k">public</span> <span class="n">ContentControl</span>
<span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">UIElement</span><span class="o">::</span><span class="n">Event</span><span class="o">&lt;</span><span class="n">DownloadCompletedHandler</span><span class="o">&gt;</span> <span class="n">DownloadCompleted</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">Event</span><span class="o">&lt;</span><span class="n">DownloadCompletedHandler</span><span class="o">&gt;</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">DownloadCompletedEvent</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">//...</span>
<span class="p">};</span>

<span class="c1">// another component registers against the event...</span>
<span class="n">DownloadHandler</span><span class="o">::</span><span class="n">DownloadHandler</span><span class="p">(</span><span class="k">const</span> <span class="n">Ptr</span><span class="o">&lt;</span><span class="n">MyControl</span><span class="o">&gt;&amp;</span> <span class="n">myControl</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">myControl</span><span class="o">-&gt;</span><span class="n">DownloadCompleted</span><span class="p">()</span> <span class="o">+=</span> <span class="n">MakeDelegate</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">DownloadHandler</span><span class="o">::</span><span class="n">OnDownloadCompleted</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">DownloadHandler</span><span class="o">::</span><span class="n">OnDownloadCompleted</span><span class="p">(</span><span class="k">const</span> <span class="n">Ptr</span><span class="o">&lt;</span><span class="n">BaseComponent</span><span class="o">&gt;&amp;</span> <span class="n">sender</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">DownloadCompletedArgs</span><span class="o">&amp;</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//...</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="raise-the-event">
<h2>Raise the Event</h2>
<p>Each event will have an asociated virtual function with the name of the event prefixed by <strong>On</strong> that will raise the event, that will allow inheritors to handle the event and cancel it. For the previous example the function will be <strong>OnDownloadCompleted</strong>.</p>
<div class="highlight"><pre><span class="k">class</span> <span class="nc">MyControl</span><span class="o">:</span> <span class="k">public</span> <span class="n">ContentControl</span>
<span class="p">{</span>
<span class="nl">protected:</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">OnDownloadCompleted</span><span class="p">(</span><span class="k">const</span> <span class="n">Ptr</span><span class="o">&lt;</span><span class="n">BaseComponent</span><span class="o">&gt;&amp;</span> <span class="n">downloadedContent</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">DownloadEventArgs</span> <span class="n">args</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">DownloadCompletedEvent</span><span class="p">,</span> <span class="n">downloadedContent</span><span class="p">);</span>
        <span class="n">RaiseEvent</span><span class="p">(</span><span class="o">&amp;</span><span class="n">args</span><span class="p">);</span>
    <span class="p">}</span>

   <span class="c1">//...</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
                        
                        </div>

                        <div class="noesis_doc_footer">
                            <div class="noesis_doc_header_bg">
                                <div class="noesis_doc_footer_text">
                                    2014 (C) Noesis Technologies
                                </div>
                            </div>
                        </div>

                    </div><!--doc_wrap-->

                </div><!--contenidosMain-->

            </div><!--main-->

        </div><!--contenedor-->

        <div id="noesis_web_stickyFooter">

            <div class="noesis_web_footerFinMain">&nbsp;</div>

            <div class="noesis_web_footerInner">
            
                <div class="noesis_web_footerCopy">
                    <a href="/privacy_policy.htm" class="noesis_web_privacy" >Privacy Policy</a><br/>
                    Copyright &copy; 2009-2012  Noesis Technologies S.L.
                </div>

                <div class="noesis_web_footerTexLinks" style="margin-left:270px;">
                    <a href="/noesis_gui_features.htm" class="noesis_web_top" >Products</a>
                    <a href="/noesis_gui_features.htm" class="noesis_web_level1">GUI</a>
                    <a href="/noesis_gui_features.htm" class="noesis_web_level2">Features</a>
                    <a href="/noesis_gui_licensing.htm" class="noesis_web_level2 noesis_web_last">Licensing</a>
                    <a href="/noesis_engine_features.htm" class="noesis_web_level1">Engine</a>
                    <a href="/noesis_engine_features.htm" class="noesis_web_level2 noesis_web_last">Features</a>
                </div>

                <div class="noesis_web_footerTexLinks" style="margin-left:45px;">
                    <a href="/company_about.htm" class="noesis_web_top" >Company</a>
                    <a href="/company_about.htm" class="noesis_web_level1">About</a>
                    <a href="/company_services.htm" class="noesis_web_level1">Services</a>
                    <a href="/company_news.php" class="noesis_web_level1">News</a>
                </div>

                <div class="noesis_web_footerTexLinks" style="margin-left:55px;">
                    <a href="/forums/" class="noesis_web_top">Support</a>
                    <a href="/forums/" class="noesis_web_level1">Forums</a>
                    <a href="/docs/" class="noesis_web_level1">Documentation</a>
                    <a href="/community_bugs.htm" class="noesis_web_level1">Bugtracking</a>
                </div>

                <div class="noesis_web_footerTexLinks" style="margin-left:20px;">
                    <a href="/contact.htm" class="noesis_web_top">Contact</a>
                </div>

            </div><!--footerInner-->

        </div><!--stickyFooter-->
        
    </div>
</div>
                    
</div>
</body>
</html>
